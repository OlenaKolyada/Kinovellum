# ADR-001: Choosing Ktor as Web Framework

**Status:** Accepted  
**Date:** 2025-10-22  
**Participants:** Developer, course instructors

## 1. Context and Problem

"Which web framework should be used for developing the backend API of the Vulpecula movie diary application in Kotlin to ensure performance (API response time ‚â§500 ms), meet educational project requirements, and gain practical experience with the target employer's technology stack?"

## 2. Architecturally Significant Requirements (ASR)

| Requirement ID | Requirement Text | Type | Source |
|----------------|------------------|------|--------|
| PERF-001 | API response time ‚â§500 ms for simple requests | NFR | Technical specification |
| MAINT-001 | Code must comply with Kotlin code conventions | NFR | Course requirements |
| LEARN-001 | Framework must be part of the course curriculum | FR | Course requirements |
| CAREER-001 | Gaining practical experience with target employer's technology stack (Ktor + AWS) | NFR | Career goals |
| SCAL-001 | Support for asynchronous request processing | NFR | Technical specification |

## 3. Analysis of Alternatives

| Requirement \ Solution | Spring Boot | Ktor | Micronaut |
|------------------------|-------------|------|-----------|
| PERF-001 | ‚ö†Ô∏è ~200ms (overhead) | ‚úÖ ~50ms (lightweight) | ‚úÖ ~80ms |
| MAINT-001 | ‚úÖ | ‚úÖ Idiomatic Kotlin | ‚úÖ |
| LEARN-001 | ‚ùå Not in curriculum | ‚úÖ Main course framework | ‚ö†Ô∏è Not covered |
| CAREER-001 | ‚ùå | ‚úÖ Used by target employer | ‚ùå |
| SCAL-001 | ‚ö†Ô∏è Reactive WebFlux | ‚úÖ Coroutines out of the box | ‚úÖ |
| Ease of learning | ‚ö†Ô∏è Complex configuration | ‚úÖ Minimalistic | ‚ö†Ô∏è Moderate |
| Artifact size | ~30 MB | ~5 MB | ~15 MB |
| AWS Lambda compatibility | ‚ö†Ô∏è Slow cold start | ‚úÖ Fast cold start | ‚úÖ |

## 4. Selected Solution

**Ktor 2.x** with:
* Kotlin Coroutines for asynchronous processing
* Serialization plugin for JSON
* Content Negotiation for working with data formats
* Call Logging for request logging
* AWS SDK for DynamoDB integration

## 5. Rationale

The solution satisfies all critical requirements:

* **PERF-001**: Ktor is a lightweight framework with minimal overhead, ensuring fast API response (~50ms)
* **MAINT-001**: Ktor is written in Kotlin and uses idiomatic Kotlin approaches (DSL for routing, coroutines)
* **LEARN-001**: Ktor is the main framework in the Kotlin Backend Developer course curriculum
* **CAREER-001**: Target company uses the Ktor + AWS + DynamoDB stack. Practical experience with this stack in an educational project will increase employment chances and reduce adaptation time
* **SCAL-001**: Built-in support for Kotlin Coroutines for efficient asynchronous processing

Additional advantages:
* Modular architecture - only necessary features are included
* Excellent integration with AWS Lambda (small artifact size, fast cold start)
* Easy testing
* Compatibility with AWS SDK for working with DynamoDB

## 6. Consequences

* ‚úÖ **Positive:**
    * Fast development thanks to framework simplicity
    * Minimal resource consumption (important for AWS Lambda)
    * Easy to learn for course student
    * Native coroutines support without additional libraries
    * Gaining relevant experience for target employer
    * Portfolio project with real technology stack

* ‚ö†Ô∏è **Negative:**
    * Smaller community compared to Spring Boot
    * Fewer ready-made integrations with external services (but not critical for educational project)

* üîß **Dependencies:**
    * ADR-002: Choosing DynamoDB as database
    * ADR-003: Integration with Keycloak for authentication

## 7. Verification

| Requirement | Verification Method | Result | Status |
|-------------|---------------------|--------|--------|
| PERF-001 | Load testing (JMeter) | p95 = 120ms @ 100 RPS | ‚úÖ |
| MAINT-001 | Code review, static analysis (detekt) | Kotlin conventions compliance | ‚úÖ |
| LEARN-001 | Course curriculum review | Ktor in modules 3-6 | ‚úÖ |
| CAREER-001 | Tech stack alignment with target company | Ktor + AWS + DynamoDB | ‚úÖ |
| SCAL-001 | Integration tests with coroutines | Successful asynchronous processing | ‚úÖ |